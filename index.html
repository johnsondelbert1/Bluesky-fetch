<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shelbee's Hub</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #121212;
            color: #fff;
            margin: 0;
            padding: 0;
        }

        .tabs {
            display: flex;
            justify-content: space-around;
            background-color: #3700b3;
        }

        .tab-button {
            flex: 1;
            text-align: center;
            padding: 15px;
            cursor: pointer;
            color: white;
            background: transparent;
            border: none;
            font-weight: bold;
        }

        .tab-button.active {
            background-color: #6200ea;
        }

        .card {
            background-color: #333;
            border-radius: 8px;
            margin: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
        }

        .card img {
            width: 100%;
            height: auto;
            border-radius: 8px;
        }

        .card-header {
            font-size: 1.2em;
            font-weight: bold;
        }

        .card-body {
            margin-top: 10px;
        }

        .subreddit {
            color: #bb86fc;
        }

        .footer {
            background-color: #6200ea;
            padding: 20px;
            text-align: center;
            color: white;
            position: fixed;
            width: 100%;
            bottom: 0;
        }

        .footer button {
            background-color: #03dac5;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 5px;
        }

        .footer button:hover {
            background-color: #018786;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .dark-mode {
            background-color: #121212;
            color: white;
        }

        .light-mode {
            background-color: #ffffff;
            color: black;
        }

        .header {
            background-color: #6200ea;
            padding: 20px;
            text-align: center;
            color: white;
        }

        .header h1 {
            margin: 0;
            font-size: 2.5em;
        }
    </style>
</head>
<body class="dark-mode">
    <div class="header">
        <h1>Shelbee's Hub</h1>
    </div>

    <div class="tabs">
        <button class="tab-button active" data-tab="reddit">Reddit Posts</button>
        <button class="tab-button" data-tab="tumblr">Tumblr Posts</button>
    </div>

    <div id="reddit" class="tab-content active">
        <div id="redditPosts"></div>
        <div id="redditError" class="error"></div>
    </div>

    <div id="tumblr" class="tab-content">
        <div id="tumblrPosts"></div>
        <div id="tumblrError" class="error"></div>
    </div>

    <div class="footer">
        <button id="refreshData">Refresh Data</button>
    </div>

    <script>
        const redditUser = 'johnsondelbert1';
        const tumblrUser = 'shelbeezz';
        const redditApiUrl = `https://www.reddit.com/user/${redditUser}/submitted.json?limit=10`;
        const tumblrApiUrl = `https://api.tumblr.com/v2/blog/${tumblrUser}.tumblr.com/posts?api_key=ZGuu8GZuo6jmos0wHBgUG4zpfdzehIBSZvXECK3wU788LrjCcN&limit=10`;

        document.getElementById('theme-toggle').addEventListener('click', () => {
            document.body.classList.toggle('dark-mode');
            document.body.classList.toggle('light-mode');
        });

        document.getElementById('refreshData').addEventListener('click', () => {
            fetchRedditPosts();
            fetchTumblrPosts();
        });

        async function fetchRedditPosts() {
            const cachedData = localStorage.getItem('redditPosts');
            const cacheTimestamp = localStorage.getItem('redditCacheTimestamp');
            const now = Date.now();

            if (cachedData && now - cacheTimestamp < 24 * 60 * 60 * 1000) {
                displayPosts('reddit', JSON.parse(cachedData));
                return;
            }

            try {
                const response = await fetch(redditApiUrl);
                const data = await response.json();
                if (data.data && data.data.children) {
                    const posts = data.data.children.map(post => post.data);
                    localStorage.setItem('redditPosts', JSON.stringify(posts));
                    localStorage.setItem('redditCacheTimestamp', now.toString());
                    displayPosts('reddit', posts);
                } else {
                    document.getElementById('redditError').innerText = 'Error fetching Reddit posts: No posts found.';
                }
            } catch (error) {
                document.getElementById('redditError').innerText = `Error fetching Reddit posts: ${error}`;
            }
        }

        async function fetchTumblrPosts() {
            const cachedData = localStorage.getItem('tumblrPosts');
            const cacheTimestamp = localStorage.getItem('tumblrCacheTimestamp');
            const now = Date.now();

            if (cachedData && now - cacheTimestamp < 24 * 60 * 60 * 1000) {
                displayPosts('tumblr', JSON.parse(cachedData));
                return;
            }

            try {
                const response = await fetch(tumblrApiUrl, { headers: { 'User-Agent': 'shelbeebot' } });
                const data = await response.json();
                if (data.response && data.response.posts) {
                    const posts = data.response.posts;
                    localStorage.setItem('tumblrPosts', JSON.stringify(posts));
                    localStorage.setItem('tumblrCacheTimestamp', now.toString());
                    displayPosts('tumblr', posts);
                } else {
                    document.getElementById('tumblrError').innerText = 'Error fetching Tumblr posts: No posts found.';
                }
            } catch (error) {
                document.getElementById('tumblrError').innerText = `Error fetching Tumblr posts: ${error}`;
            }
        }

        function displayPosts(platform, posts) {
            const container = document.getElementById(`${platform}Posts`);
            container.innerHTML = '';

            posts.forEach(post => {
                const card = document.createElement('div');
                card.className = 'card';

                if (platform === 'reddit') {
                    const postTitle = document.createElement('div');
                    postTitle.className = 'card-header';
                    postTitle.innerHTML = `<a href="https://www.reddit.com${post.permalink}" target="_blank">${post.title}</a>`;

                    const subreddit = document.createElement('div');
                    subreddit.className = 'subreddit';
                    subreddit.innerText = `Subreddit: ${post.subreddit}`;

                    const postBody = document.createElement('div');
                    postBody.className = 'card-body';
                    postBody.innerText = post.selftext;

                    card.appendChild(postTitle);
                    card.appendChild(subreddit);
                    card.appendChild(postBody);

                    if (post.url && post.url.endsWith('.jpg')) {
                        const image = document.createElement('img');
                        image.src = post.url;
                        card.appendChild(image);
                    }
                }

                if (platform === 'tumblr') {
                    const postTitle = document.createElement('div');
                    postTitle.className = 'card-header';
                    postTitle.innerHTML = `<a href="${post.post_url}" target="_blank">${post.summary || post.text}</a>`;

                    const postBody = document.createElement('div');
                    postBody.className = 'card-body';
                    postBody.innerText = post.body || '';

                    card.appendChild(postTitle);
                    card.appendChild(postBody);

                    if (post.photos) {
                        post.photos.forEach(photo => {
                            const image = document.createElement('img');
                            image.src = photo.original_size.url;
                            card.appendChild(image);
                        });
                    }
                }

                container.appendChild(card);
            });
        }

        // Fetch posts initially
        fetchRedditPosts();
        fetchTumblrPosts();
    </script>
</body>
</html>
